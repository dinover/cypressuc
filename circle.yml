# testing using CircleCI orb
# see https://on.cypress.io/circleci-orb

# for non-orb configuration see old commit
# https://github.com/cypress-io/cypress-example-kitchensink/blob/aabb10cc1bb9dee88e1bf28e0af5e9661427ee7a/circle.yml

# to use CircleCI orbs need to use version >= 2.1
version: 2.1
orbs:
  # use Cypress orb from CircleCI registry
  cypress: cypress-io/cypress@1.16.1
jobs:
  linux-build:
    jobs:
      - cypress/install
      - cypress/run:
        requires:
          - cypress/install
        name: '2 machines using Chrome'
          # use executor with Chrome installed
        executor: cypress/browsers-chrome76
        browser: chrome
        record: true
        key: 
        parallel: true
        parallelism: 2
        group: '2x-chrome on CircleCI'
        spec: cypress/integration/Sections/*
        start: 'npm run start:ci'

      - release:
          filters:
            branches:
              only:
                - master
          requires:
            - 2 machines
